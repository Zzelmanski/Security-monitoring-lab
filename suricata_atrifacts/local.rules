# --- Existing rule ---
alert icmp any any -> any any (msg:"TEST ICMP ALERT"; sid:1000101; rev:1;)

alert tcp any any -> any any (msg:"LAB IMMEDIATE TCP ANY"; sid:1999999; rev:1;)

# --- New Rules ---

# 1. Detect any HTTP traffic (basic example)
alert tcp any any -> any 80 (msg:"HTTP traffic detected"; sid:1000102; rev:1;)

# 2. Detect DNS queries
alert udp any any -> any 53 (msg:"DNS query detected"; sid:1000103; rev:1;)

# 3. Detect SSH connection attempts
alert tcp any any -> any 22 (msg:"SSH connection attempt detected"; sid:1000104; rev:1;)

# 4. Detect RDP (Remote Desktop Protocol) connections
alert tcp any any -> any 3389 (msg:"RDP connection detected"; sid:1000105; rev:1;)

# 5. Detect ping from specific IP (replace with your VM IP if known)
alert icmp 192.168.56.103 any -> any any (msg:"Ping from host detected"; sid:1000106; rev:1;)

# 1000301 - Detect likely SYN scan from one source (rate-limited)
alert tcp any any -> any any (msg:"LAB NMAP POSSIBLE SYN SCAN"; flags:S; threshold:type limit,track by_src,count 20,seconds 60; sid:1000301; rev:1;)

# 1000302 - Detect XMAS scan (FIN+PSH+URG)
alert tcp any any -> any any (msg:"LAB NMAP XMAS SCAN"; flags: FIN,PSH,URG; sid:1000302; rev:1;)

# 1000303 - Detect NULL scan (no flags)
alert tcp any any -> any any (msg:"LAB NMAP NULL SCAN"; flags: 0; sid:1000303; rev:1;)

# 1000304 - Detect a fast full TCP connect scan pattern (many distinct ports in short time)
# This uses thresholding to avoid single legitimate connections triggering it.
alert tcp any any -> any any (msg:"LAB NMAP POSSIBLE CONNECT SCAN"; flags:S; threshold:type limit,track by_src,count 50,seconds 30; sid:1000304; rev:1;)

# 1000305 - Detect Nmap service/version probes by common user-agent or banner scanner signature (example)
alert tcp any any -> any 80 (msg:"LAB NMAP HTTP USER-AGENT probers (nmap)"; content:"User-Agent: Nmap Scripting Engine"; nocase; sid:1000305; rev:1;)